# 会社RPAシステム

## 概要
このプロジェクトは、会社のRPA（Robotic Process Automation）システムを実装したものです。機種、棚数、インチ数、高さの4つの入力値から、内部ルールベースと計算により、A、B、C、D、Hの数値を出力します。

## 機能
- 4つの入力値（機種、棚数、インチ数、高さ）の受け取り
- 機種別のルールベース計算
- チェーンデータとリング数の自動選択
- A、B、C、D、H値の計算
- GUIインターフェース
- Excelファイルへの出力機能
- 一括処理機能

## システム仕様

### 対応機種
- **200**: チェーンデータ31.75、データ1: 20
- **201**: チェーンデータ31.75、データ1: 20  
- **350**: チェーンデータ50.8、データ1: 14
- **351**: チェーンデータ50.8、データ1: 14

### インチ数とリング数の対応
- **200**: インチ数[10,11,12,14,15,16,18,19,20] → リング数[8,9,10,11,12,13,14,15,16]
- **201**: インチ数[10,11,12,14,15,16,18,19,20] → リング数[8,10,11,12,13,14,15,16]
- **350**: インチ数[10,11,12,14,15,16,18,19,20] → リング数[5,6,7,8,9,10,11,12]
- **351**: インチ数[10,11,12,14,15,16,18,19,20] → リング数[5,6,7,8,9,10,11,12]

### 計算式

#### A値の計算
```
A = ((棚数 × リング数 - データ1) ÷ 2 × チェーンデータ) + 60
```

#### B値の計算
- **200**: 高さ>2750 → 250, 高さ≥2500 → 225, 高さ≥2250 → 0
- **201**: 高さ>3000 → 250, 高さ≥2750 → 200, 高さ≥2500 → 175, 高さ≥2250 → 0
- **350, 351**: 0（仕様なし）

#### H値の計算（350, 351のみ使用）
- **10, 12インチ**: 388
- **14, 16インチ**: 288
- **200, 201**: 使用しない（0）

#### C値の計算
高さの分解能は250で、H3=高さ3000から始まります。

**200の場合:**
- H4(3250)=630, H5(3500)=1000, H6(3750)=1000, H7(4000)=1500, H8以降=1500

**201の場合:**
- H4(3250)=730, H5(3500)=980, H6(3750)=1000, H7(4000)=1480, H8以降=1500

**350の場合:**
- H3(3000)=1000, H4(3250)=1000, H5(3500)=1000, H6(3750)=1500, H7(4000)=2000, H8以降=2000

**351の場合:**
- H3(3000): 14,16インチ=850, 10,12インチ=950
- H4(3250): 14,16インチ=900, 10,12インチ=1000
- H5(3500): 14,16インチ=900, 10,12インチ=1000
- H6(3750)=1500, H7(4000)=1900, H8以降=1900

#### D値の計算
**200の場合:**
- H11(5750)=1000, H12(6000)=1000, H13(6250)=1500, H14以降=1500

**201の場合:**
- H11(5750)=980, H12(6000)=1000, H13(6250)=1480, H14以降=1500

**350, 351の場合:**
- H10(5500)=500, H11(5750)=500, H12(6000)=1000, H13(6250)=1000, H14(6500)=1500, H15(6750)=1500, H16(7000)=2000, H17(7250)=2000

## インストール方法

### 方法1: conda環境を使用（推奨）

#### Windows
```bash
# セットアップスクリプトを実行
setup_conda.bat

# または手動で実行
conda env create -f environment.yml
conda activate rpa-system
```

#### Linux/Mac
```bash
# セットアップスクリプトを実行
chmod +x setup_conda.sh
./setup_conda.sh

# または手動で実行
conda env create -f environment.yml
conda activate rpa-system
```

### 方法2: pipを使用

```bash
pip install -r requirements.txt
```

### 必要なパッケージ一覧
- **conda環境**: `environment.yml`で管理
- **pip環境**: `requirements.txt`で管理
- **共通**: tkinter (Python標準ライブラリ)、pandas、openpyxl、pyautogui、pyperclip、pillow

## 使用方法

### 基本版の実行
```bash
# conda環境を使用する場合
conda activate rpa-system
python rpa_system.py

# または直接実行
python rpa_system.py
```

### Excel連携版の実行
```bash
# conda環境を使用する場合
conda activate rpa-system
python rpa_excel_system.py

# または直接実行
python rpa_excel_system.py
```

## ファイル構成
```
├── README.md                    # このファイル
├── requirements.txt             # pip用パッケージ一覧
├── environment.yml              # conda用環境設定
├── setup_conda.bat             # Windows用condaセットアップ
├── setup_conda.sh              # Linux/Mac用condaセットアップ
├── setup_conda.ps1             # PowerShell用condaセットアップ
├── rpa_system.py               # 基本版RPAシステム
├── rpa_excel_system.py         # Excel連携版RPAシステム
├── sample_data.csv             # サンプルデータ
├── cdh                         # C、D、H値の計算仕様書
└── ある新しいプロジェクトを作ります。.ini  # 仕様書
```

## 使用例

### 例1: 機種200、インチ数12、棚数16の場合
- リング数: 10
- A = ((16×10-20)÷2×31.75)+60 = 2282.5
- H値: 0（200は使用しない）

### 例2: 機種201、高さ3000の場合
- B = 250 (高さ>3000のため)
- H値: 0（201は使用しない）

### 例3: 機種350、高さ3250、インチ数14の場合
- H値: 288 (14インチのため)
- C値: 1000 (H4=3250のため)
- D値: 0 (H4ではD値なし)

### 例4: 機種351、高さ3000、インチ数10の場合
- H値: 388 (10インチのため)
- C値: 950 (H3=3000、10インチのため)
- D値: 0 (H3ではD値なし)

## conda環境の管理

### 環境の削除
```bash
conda env remove -n rpa-system
```

### 環境の更新
```bash
conda env update -f environment.yml
```

### インストール済みパッケージの確認
```bash
conda activate rpa-system
conda list
```

## 注意事項
- 機種350、351のB値計算ルールは仕様書に記載がないため、現在は0を返します
- C、D、H値の計算はCDHファイルの仕様に基づいて実装されています
- H値は機種350、351でのみ使用され、機種200、201では使用されません
- 高さの分解能は250で、H3=3000からH17=7250まで対応しています
- 入力値は数値のみ受け付けます
- conda環境を使用することを推奨します（依存関係の管理が容易）

## ライセンス
このプロジェクトは会社内での使用を目的としています。

## サポート
技術的な質問や問題がございましたら、開発チームまでお問い合わせください。

# 1. パッケージインストール
pip install pandas openpyxl pyautogui pyperclip pillow

# 2. 実行
python rpa_system.py